<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¨Ø²Ø§Ø± Ø¯Ø± Ú¯Ø±Ø¯Ø´</title>
<style>
    @font-face {
        font-family: "B Nazanin";
        src: url("/static/fonts/B-NAZANIN.TTF") format("truetype");
    }
    body {
        font-family: "B Nazanin", Arial, sans-serif;
        direction: rtl;
        margin: 20px;
    }
    h1 {
        text-align: center;
        font-weight: bold;
    }
    form {
        margin-bottom: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 12px;
        background: white;
    }
    input, select, button {
        margin: 5px;
        padding: 8px;
        border-radius: 8px;
        border: 1px solid #aaa;
        font-family: "B Nazanin", Arial, sans-serif;
    }
    button {
        background: #007bff;
        color: white;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 2px 2px 5px #999;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        border: 1px solid #666;
        padding: 6px;
        text-align: center;
        font-weight: bold;
        font-family: "B Nazanin", Arial, sans-serif;
    }
    th { background: #eee; }
    td.threads {
        font-size: 0.9em;
    }
    td.description input {
        width: 95%;
        padding: 4px;
        font-size: 0.9em;
    }
    .operations button {
        margin: 2px;
        padding: 5px 10px;
    }
    a { color: blue; text-decoration: none; }
</style>
</head>
<body>

<h1>Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¨Ø²Ø§Ø± Ø¯Ø± Ú¯Ø±Ø¯Ø´</h1>

<!-- ÙØ±Ù… Ø«Ø¨Øª Ø§Ø¨Ø²Ø§Ø± -->
<form method="POST" action="/add" enctype="multipart/form-data">
    <label>Ø«Ø¨Øª Ø¯Ø³ØªÛŒ Ø§Ø¨Ø²Ø§Ø±:</label><br>
    <input type="text" name="tool_type" placeholder="Ù†ÙˆØ¹ Ø§Ø¨Ø²Ø§Ø±">
    <input type="text" name="serial_number" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ø³Ø±ÛŒØ§Ù„">
    <input type="text" name="size" placeholder="Ø³Ø§ÛŒØ²">
    <input type="text" name="thread_type" placeholder="Ù†ÙˆØ¹ Ø±Ø²ÙˆÙ‡">
    <input type="text" name="location" placeholder="Ù…Ø­Ù„ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ">
    <select name="status">
        <option value="Ready to Use">Ready to Use</option>
        <option value="Need to Repair">Need to Repair</option>
        <option value="Need to Sandblast">Need to Sandblast</option>
        <option value="Scrap">Scrap</option>
        <option value="Class 2">Class 2</option>
        <option value="Need to Inspection">Need to Inspection</option>
    </select>
    <button type="submit">Ø«Ø¨Øª Ø§Ø¨Ø²Ø§Ø±</button>
</form>

<!-- ÙØ±Ù… Ø¢Ù¾Ù„ÙˆØ¯ Ø§Ú©Ø³Ù„ -->
<form method="POST" action="/upload_excel" enctype="multipart/form-data">
    <label>Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„:</label><br>
    <input type="file" name="excel_file" accept=".xlsx">
    <button type="submit">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ</button>
</form>

<!-- ÙØ±Ù… Ø¬Ø³ØªØ¬Ùˆ -->
<form method="get" action="/">
    <input type="text" name="tool_type" placeholder="Ù†ÙˆØ¹ Ø§Ø¨Ø²Ø§Ø±">
    <input type="text" name="serial_number" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ø³Ø±ÛŒØ§Ù„">
    <input type="text" name="size" placeholder="Ø³Ø§ÛŒØ²">
    <input type="text" name="thread_type" placeholder="Ù†ÙˆØ¹ Ø±Ø²ÙˆÙ‡">
    <input type="text" name="location" placeholder="Ù…Ø­Ù„ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ">
    <select name="status">
        <option value="">ÙˆØ¶Ø¹ÛŒØª</option>
        <option value="Ready to Use">Ready to Use</option>
        <option value="Need to Repair">Need to Repair</option>
        <option value="Need to Sandblast">Need to Sandblast</option>
        <option value="Scrap">Scrap</option>
        <option value="Class 2">Class 2</option>
        <option value="Need to Inspection">Need to Inspection</option>
    </select>
    <button type="submit">Ø¬Ø³ØªØ¬Ùˆ</button>
    <a href="/"><button type="button">Ù†Ù…Ø§ÛŒØ´ Ù‡Ù…Ù‡</button></a>
</form>

<!-- Ø¬Ø¯ÙˆÙ„ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ -->
<table>
    <tr>
        <th>Ø´Ù†Ø§Ø³Ù‡</th>
        <th>Ù†ÙˆØ¹ Ø§Ø¨Ø²Ø§Ø±</th>
        <th>Ø´Ù…Ø§Ø±Ù‡ Ø³Ø±ÛŒØ§Ù„</th>
        <th>Ø³Ø§ÛŒØ²</th>
        <th style="width:120px;">Ù†ÙˆØ¹ Ø±Ø²ÙˆÙ‡</th>
        <th>Ù…Ø­Ù„ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ</th>
        <th>ÙˆØ¶Ø¹ÛŒØª</th>
        <th style="width:150px;">Ø¹Ù…Ù„ÛŒØ§Øª</th>
        <th>Ø´Ø±Ø­</th>
        <th>Ú¯Ø²Ø§Ø±Ø´</th>
    </tr>
    {% for item in items %}
    <tr>
        <td>{{ item[0] }}</td>
        <td>{{ item[1] }}</td>
        <td style="direction:ltr;">{{ item[2] }}</td>
        <td style="direction:ltr;">{{ item[3] }}</td>
        <td class="threads">{{ item[4] }}</td>
        <td>{{ item[5] }}</td>
        <td>{{ item[6] }}</td>
        <td class="operations">
            <a href="/edit/{{ item[0] }}"><button>ÙˆÛŒØ±Ø§ÛŒØ´</button></a>
            <a href="/delete/{{ item[0] }}"><button>Ø­Ø°Ù</button></a>
        </td>
        <td class="description">
            <input type="text" value="{{ item[8] or '' }}">
        </td>
        <td>
            {% if item[7] %}
                <a href="{{ item[7] }}" target="_blank">ğŸ“„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú¯Ø²Ø§Ø±Ø´</a>
            {% else %}
                -
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

</body>
</html>
